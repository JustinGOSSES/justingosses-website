---
title: 'All models are wrong, some are useful: Comparing geologic maps and large language models'
date: 2023-12-30T15:32:14Z
lastmod: '2023-12-30'
tags: ['AI', 'machine-learning', 'open-ai', 'geology', 'bot', 'nlp', 'experiments', 'side-projects']
draft: true
summary: 'Wrong but useful, comparing geologic maps and large language models as two different types of models.'
layout: PostSimple
bibliography: references-data.bib
canonicalUrl: https://justingosses.com/blog/adding-rss-to-this-website/
---

## A post mortem on an experimental web application that combined geologic maps with LLMs

When discussing errors of Large Language Models (LLMs) the term 'hallucination' is used
a lot to discuss factual errors. However, this always struck me as a bit of an awkward
framing as LLMs. 
To some extent I understand why that term is used, as 'hallucination' was previously used to describe
early generative imagery, which did indeed look dreamy. LLMs also first got huge public attention 
in the form of ChatGPT's search box interface, which reminds everyone of the google search box, 
which does pull from an index of real websites. Hence, it makes sense that people would expect 
it to be pulling from an index of real facts.

Despite the similarities, LLMs aren't built in a way that it would be reasonable to expect them 
to be magic eight balls that
pull exclusively from repositories of facts. They're built to be probabilistic
models of human language that extend text given in prompts.
The saying that pops into my head for LLMs is `"all models are wrong but some are useful".`, 
which is typically something head when discussing scientific models.
I like this saying for LLMs as it affirms that LLMs are going to be wrong, we should be
thinking about how we should expect them to be wrong, and we should be thinking about how to 
reasonably expect them to be useful.

Another reason to like the saying is it invites
a comparison between geologic maps, which are one type of model, with LLM generated
geology field trip point descriptions, which are a different type of model.
The ways in which these two different types of models are wrong but still useful have overlap 
as well as differences. 

This blog post will attempt to do two things at once. 
First, it will serve as a post mortem for an experimental web application I built that
applies GPT3 and GPT4 large language models to the problem of generating plausible language that you might 
hear said by the leader of a geology field trip at any random point location on Earth. 
Second, this blog post will attempt to describe the similar and different ways in which two 
types of models, geologic maps and LLMs, can be both wrong and still useful.

## What was built

### Outline of the web application
A [previous blog post](https://justingosses.com/blog/LLM-AI-bot-for-geology-field-trips) 
summarized what was being attempted very early on in the process.

The basic idea is a user can navigate an area using a street, topographic, or geologic map. 
When they click on any of the maps, a red point is added on all maps at that location. 
Additionally, if there is a Google streetview near the point clicked, it will appear as well. 
There is another green button below, that the user can click to generate text that
attempts to mirror what would be said at a geology field trip stop at that exact location.

#### Where to try it out
The live website, which may or may not be still live when you read this, is at 
[https://app-lagdal.azurewebsites.net/](https://app-lagdal.azurewebsites.net/) 
You can also clone 
the [https://github.com/JustinGOSSES/LAGDAL](https://github.com/JustinGOSSES/LAGDAL) 
repository locally and then follow the instructions to set up API keys for OpenAI, 
google streetview, and Bing maps such that the application runs on your local computer.

#### Who was it built for?
The application had a user in mind who was someone with geologic knowledge looking to 
explore a new area, maybe searching for good field trip stop locations. It was also 
built with the question in mind of how much closer LLMs could take us to 
a completely automated field trip guide, at some basic level. 

### How I used it: on vacation

Most of my use of it was in testing, but I also used it for vacations. 
Normally, geologic field trips require significant research and one or more persons
leading who know a lot about an area.  As someone trained as a geologist 
now working in other professions, I often like to learn a bit about the geology of 
the place I'm visiting, so I can understand the context of any outcrops I happen to see. 
LAGDAL is useful for this task as it lets me look in advance at where I might see 
outcrops and understand the different geologic units. It's better than just a basic
geologic map as the topographic map combined with the streetview imagery 
lets me easily see real outcrop pictures of each geologic unit before I'm there in person. 
The LLM field trip 
descriptions also provide some regional context that a geologic map description by itself 
doesn't not give. 

I've used it on travel to Cleveland, Ohio, Seattle, WA, Provence France, and Taipei, Taiwan.
I've found it more useful then the online Macrostrat geologic map alone or combined 
with Google/Bing search results.

### What new capabilities were used?

- Syncing of topographic, street, and geologic map as well as street view imagery.

- Large language model generation of field trip descriptions

- Combination of geologic map text as primer for LLM text generation

#### Basic flow of LLM text generation

The basic flow of text generation involved several API calls. 
- Find geologic unit data at a given latitude and longitude based on Macrostrat API.
- Use bing map API to find geographic name  from latitude and longitude.
- Use OpenAI API to summarize geologic unit data from Macrostrat API into paragraph form from JSON format.
- Use OpenAI API to get description of local geology using paragraph from previous step as prompt.
- Use OpenAI API to get combined local and regional geology description using paragraph from last step in prompt. 

These skills and a few others are available to an agent that picked which to use, but 
it mostly picked them in the order shown above.

## Post Mortem: Non-model related

### Too slow

The text generation involved multiple OpenAI and other API models, which meant
the time between clicking the "generate" button and getting a description of
the field trip location could be several minutes in total. This is too slow
for many users, who are used to immediate feedback on websites. One way to
minimize this might be to have the intermediate results printed to the
website window as well. This the experience when running via command line
and it results in less waiting but not zero waiting.

### Poor experience on a mobile device

This prototype was developed quickly on a laptop, and it has not been
optimized for a mobile experience. There are two elements that could be
improved. First, the four map elements appear in the same locations
on small mobile screens, which makes it hard to see fine details.
Ideally, on mobile each map window would be full screen width and
positioned in a vertical column of elements. This would make them
easier to see. Second, the small size makes it annoying to navigate the map.
Having each map element be full screen width would help with navigation
of the map, but ideally there would also be a button to push to
navigate the map to your actual location and an input form where you
could type in an address for the maps to navigate to. Both of these
would improve the map navigation experience on mobile.

## Post Mortem: Model related 
## Comparing geologic maps as models and large language models. Wrong and useful in different ways

### Geologic maps as imperfect models
As alluded to in the first section, geologic maps are imperfect models.
However, the statement `all models are wrong but some are useful` applies 
as they are still extremely useful despite certain common errors. 

##### Error type 1: Dirt and other non-interesting things in the way
To start with, there's often other stuff on top, be it dirt, vegetation, or 
buildings. Geologic maps try to indicate what's underneath all of that even if it is 
quite far down. What's shown on the map therefor can often be an imperfect guess at 
what's underneath. In landscapes with a lot of vegetation, the error rate can be higher.

##### Error type 2: Geologists different in what content they would like to see represented on geologic maps
Another class of error is when there's a difference between what the map maker tried to represent 
and what the person using the map wants to know.

While geologic maps generally describe rocks, there is also geologists known as 
geomorphologists that study erosion and more recent unlithified sediments. 
The extent to which these more recent or unlithified sediments are included on 
geologic maps varies and can impact the maps usefulness for some users.
Additionally, while geologic maps often focus on the lithology of bedrock, 
they can also describe recent geomorphology, structural features like strike and dip orientation 
of strata, age, or presence of fossils.
Sometimes maps can be right but not in a way that is useful to you.

##### Error type 3: Resolution 
It is not unusual for geologic maps to cover hundreds of square kilometers. As such, 
the geologic units represent large generalizations of the geology, rather than exact
conditions at every point on the map. 
It is not strange for a local outcrop to contain shale where as the
geologic map says sandstone if the unit mostly sandstone. 
The spatial boundaries beween units is often more complicated that what is 
represented on a map and what is represented on a map is often guessed at on the basis 
of outcrops that peak through all the dirt, vegetation, roads, buildings, etc.

##### Resolution variations across Macrostrat geologic map
The geologic map used on the LAGDAL application is from Macrostrat that integrates a large
number of digital geologic maps from different parts of the world. As such, there is quite 
a bit of variation in the resolution of the mapping. Taiwan has only a handfull of geologic 
units mapped and there is a lot of differences between what's on the map and 
what's exposed in outcrops. In contrast, the geologic maps in Texas or southern France are 
mapped in higher resolution with comparably less differences likely between what's on the map and
what's exposed in outcrops.

##### Reasonable to expect geologic maps to be wrong at times

For all these reasons, it should not be all that surprising that when you're faced 
wih an outcrop that doesn't agree with the what the geologic map suggests should be there.
The geologic map is useful even if its wrong at times because most advanced users 
have expectations on where and how it might be wrong. 

gAs the saying goes, the model is 
wrong but still useful. It gives us lots of useful information about the world, how 
to think about it, and what to expect even if it is sometimes wrong where we happen to 
being standing at the moment. 

### Large language models as imperfect models

LLMs in the context of the LAGDAL application are a combination of the errors of geologic 
maps and their own style of errors. 

#### Errors inherited from geologic maps

Effecting prompting construction is often necessary to get LLMs to generate useful text as 
prompts effectively act to constrain the probabilities of what the LLM will generate.
As the agent is chaining several prompts together with an initial prompt that leverages
a JSON data structure filled with data from a given latitude and longitude point on the map, 
the errors in that initial data will, to a large extent, be inherited by the LLMs.

However, LLMs are way more flexible than geologic maps in an important way, they can 
take input from user. We didn't implement this in the prototype, but I will discuss some 
possibilities there are some traditional sources of errors or negative impacts on usefulness 
in geologic maps that could be overcome with LLMs.

##### Error type 1: Dirt and other non-interesting things in the way

To a large extent these errors simply get inherited from the geologic map. 
LLMs have no other way of knowing what's underneath the dirt, vegetation, or buildings. 

However, there may be some potential here for LLMs to be more useful than geologic maps 
simply because they aren't static products. As such, there could be ways to structure the 
prompts such that some of the uncertainty around cover gets included in the generated text. 
For example, it would be possible to start the prompt chain with both the geologic map data
at that single point and several other points a short distance away. If there's differences 
in the description, then maybe that could be integrated into the generated text to warn the 
user. Additionally, information on the thickness of the units is often part of the data that 
builds the map, but not visually represented on the map due to the 2D spatial nature of the map.
However, there's nothing stopping an LLM from stating the first unit is X but it may only be 
less than 2 meters thick so you might instead be seeing the second unit of blank.

##### Error type 2: Geologists different in what content they would like to see represented on geologic maps

In the current prototype, the limitations of geologic maps are inherited by the LLMs. The 
focus of what the authors of the geologic maps that were integrated into Macrostrat is what 
is represented in the generated text. 

However, this is an area where LLMs could really shine compared to geologic maps.
While maps are static 2D representations of the geology by one group of people that is used 
by a different group of people, LLMs are dynamic and with prompts that can be altered by the user.
It would be easy to stick a knob on the web application prototype that says 
"geologist, geomorphologist, structural geologist, or paleontologist" and then the field 
trip description be generated specifically for that type of geologist. You could also 
imagine options for experience level, where the generated text is more or less technical
for audiences of elementary school students, high school students, undergraduates, or 
graduate students. Again this, was not build into the prototype but a few experiments with 
manually altering the prompts suggest that this would be a relatively easy thing to do.

##### Error type 3: Resolution

The resolution problem from geologic maps is largely inherited by the LLMs. 

However, there are circumstances where LLMs can bring in higher resolution information. 
For example, when exploring 
Taipei, Taiwan, the geologic map is very low resolution. However, the prompt given to LLMs
includes both the city name and the formation name enabling the LLM to reference additional 
information about volcanic history 
of [Yangmingshan national park](https://en.wikipedia.org/wiki/Yangmingshan).
This is information that likely existed in many texts in the LLMs training set and represents 
more information that was included in the geologic map.

Similarly, the prompt that asks for regional geology to be included in the generated text 
extends informational content beyond what is included from the geologic map.

These extensions into information not in the geologic map data tend to useful and not errors 
as they are being constrained by the geologic map data. 

#### LLM specific errors






-----------------------------------------

### Examples

#### Port Clinton, Ohio, USA

![Port Clinton Screenshot](../static/images/blog/LAGDALimages/Screenshot_PortClinton.png)

```
Geology Response: Good morning, everyone! Welcome to our geology field trip. Today,
 we find ourselves at a fascinating location with a rich geological history. 
 At this point location, the uppermost  surface geology is composed of Paleozoic 
 sedimentary rocks and Middle Devonian sedimentary rocks.  The Paleozoic sedimentary
  rocks are from the Paleozoic era, which is 251.902 to 538.8 million 
 years old. The Middle Devonian sedimentary rocks are from the Middle Devonian 
 era, which is  382.7 to 393.3 million years old. Both layers are composed of 
 sedimentary rocks, which were likely deposited in a variety of environments.
 To understand the geologic story of this area, we need to zoom out and look at 
 the regional geology. Our location lies within the  broader context  of the 
 Appalachian Basin, which stretches across several states. The Appalachian Basin is a 
 sedimentary basin that formed during the Paleozoic era, and it is known for its 
 extensive deposits of sedimentary rocks.During the Paleozoic era, this region was 
 covered by a shallow sea, known as the Appalachian Basin Sea. The deposition of 
 sediments in this sea resulted in the formation of the Paleozoic sedimentary rocks 
 we see here. These rocks were likely deposited in a variety of environments, including 
 shallow marine, deltaic, and fluvial settings. Over millions of years, layers upon 
 layers of sediment accumulated, compacted, and lithified to form the rock formations 
  we observe today.Moving forward in time, we come to the Middle Devonian era. 
  During this period, the sea that once covered this region began to recede, and the 
  environment transitioned from marine to terrestrial. The Middle Devonian sedimentary 
  rocks we see here were likely deposited in a variety of environments, including 
  river systems, floodplains, and deltas. These rocks provide valuable insights 
  into the ancient landscapes and ecosystems that existed during this time. As we 
  examine the outcrop in front of us, we can observe the distinct layering and 
  sedimentary structures within the rocks. These features tell us about the processes 
  that shaped this area millions of years ago. We may also find fossils within these 
  sedimentary rocks, which can provide clues about the ancient organisms that once 
  inhabited this region.In conclusion, the geologic story of this location is one of 
  ancient seas, changing environments, and the deposition of sedimentary rocks over 
  millions of years. The Paleozoic and Middle Devonian sedimentary rocks we see here 
  are a testament to the dynamic geological history of the Appalachian Basin. So, 
  let's take a closer look at the rocks, examine their characteristics, and see what else we
  can uncover about the fascinating geology of this area.
```

#### Houston, Texas, USA

![Houston Screenshot](../static/images/blog/LAGDALimages/Screenshot_Houston.png)

```
Location: latitude = 29.760082, longitude = -95.432943

Geology Response: Good morning, everyone! Welcome to our geology field trip. Today, we find ourselves at latitude 29.760082 and longitude -95.432943, where we have a fantastic opportunity to explore the fascinating geologic history of this region.At this point location, the uppermost surface geology is composed of Pleistocene sedimentary rocks, which date back to approximately 0.0117 million years ago. These sedimentary rocks were formed during the Pleistocene Epoch, a time characterized by repeated glaciations and interglacial periods. The Pleistocene sediments here consist of various types of sedimentary rocks, such as sand, silt, and clay, which were deposited by rivers, wind, and other natural processes.Beneath the Pleistocene sediments, we have the Beaumont Formation, which is composed primarily of clay and silt. This formation dates back to around 0.6558 million years ago and provides us with valuable insights into the geological processes that shaped this region. The Beaumont Formation was deposited in flood basins, coastal lakes, and former stream channels on a deltaic plain.Now, let's zoom out and take a look at the broader regional geology. Our current location lies within the Gulf Coastal Plain, a vast region that stretches from the Gulf of Mexico to the interior of the continent. This plain is characterized by a relatively flat topography and is primarily composed of sedimentary rocks.The Gulf Coastal Plain was formed over millions of years through the deposition of sediments eroded from the surrounding highlands and carried by rivers and streams. These sediments were then deposited in various environments, including river floodplains, deltas, and coastal areas, resulting in the diverse sedimentary rock formations we see today.Throughout its geologic history, this region has experienced significant changes in sea level, climate, and tectonic activity, all of which have influenced the deposition and erosion of sediments. The repeated cycles of sea-level rise and fall during the Pleistocene Epoch, for example, played a crucial role in shaping the landscape we see today.In addition to the Pleistocene and Beaumont Formation, other notable rock units in this region include the Lissie Formation, the Frio Formation, and the Yegua Formation, each representing different periods of deposition and environmental conditions.As we continue our field trip, I encourage you all to observe the various rock outcrops and formations we encounter along the way. By studying the geology of this region, we can gain a deeper understanding of the Earth's dynamic processes and the intricate history that has shaped our surroundings.Let's move on and explore more of the fascinating geology this region has to offer.
```

#### Bocas del Toro, Panama

![Bocas del Toro Screenshot](../static/images/blog/LAGDALimages/ScreenshotBocasDelToro.png)

```
Location: latitude = 9.344765, longitude = -82.170057

Geology Response: Good morning, students! Welcome to our geology field trip. Today, we find ourselves at a fascinating location with coordinates latitude = 9.344765 and longitude = -82.170057. As we observe the rock outcrop in front of us, we can see that the uppermost surface geology is Neogene sedimentary.This layer of sedimentary rocks tells us a story about the geologic history of this region. The Neogene period, which began approximately 2.58 million years ago and ended around 23.03 million years ago, was a time of significant geological activity. During this period, the Earth experienced major climatic changes and the emergence of diverse life forms.The presence of sedimentary rocks suggests that this area was once a sedimentary environment, such as a river delta or a shallow marine environment. Sedimentary rocks are formed through the accumulation and compaction of sediments, which can include materials like sand, silt, and clay. Over time, these sediments become lithified, forming solid rock layers.Now, let's zoom out and consider the regional geology. Our current location lies within the broader context of Central America, a region known for its complex tectonic history. Central America is situated at the boundary between the Caribbean Plate and the Cocos Plate, which are both part of the larger tectonic puzzle in this area.The collision and subduction of these plates have played a significant role in shaping the geology of Central America. The ongoing subduction of the Cocos Plate beneath the Caribbean Plate has led to the formation of volcanic arcs, such as the Central American Volcanic Arc, which stretches from Guatemala to Panama.In addition to volcanic activity, the tectonic forces at play have also resulted in the formation of mountain ranges and the uplifting of sedimentary basins. These processes have contributed to the deposition of sedimentary rocks, like the ones we see here, as well as the creation of diverse landscapes and ecosystems.Furthermore, Central America has a rich history of seismic activity due to the tectonic forces in the region. Earthquakes and volcanic eruptions are common occurrences, reminding us of the dynamic nature of our planet.In conclusion, the Neogene sedimentary rocks we observe at this location provide a glimpse into the geological history of Central America. They tell a story of ancient sedimentation in a sedimentary environment, shaped by the tectonic forces and volcanic activity that have shaped this region over millions of years. As we continue our field trip, let's keep our eyes open for more clues and evidence of the fascinating geologic processes that have shaped this part of the world.
```
#### Taiwan

![Taiwan Screenshot](../static/images/blog/LAGDALimages/Screenshot_taiwanYugi.png)

```
Geology Response: Welcome, students, to this exciting geology field trip! Today, we find ourselves at a fascinating location with coordinates latitude = 25.178327 and longitude = -238.437555. Direct your attention to the rock outcrop in front of us, which provides a glimpse into the geologic history of this region.At this point location, the uppermost surface geology is composed of intermediate volcanic rocks from the Pliocene epoch, approximately 5.333 million years ago. Although the thickness of this layer is unknown, it is a significant clue to understanding the regional geology.To fully comprehend the geologic story of this area, we must consider the broader context. The Pliocene epoch was a time of intense volcanic activity in this region. The volcanic rocks we observe here were formed through the eruption of magma from the Earth's mantle. These eruptions were likely associated with the movement of tectonic plates and the creation of new crust.As we delve deeper into the regional geology, we discover that this area is part of a larger volcanic arc. Volcanic arcs are formed when one tectonic plate subducts beneath another, leading to the melting of the subducting plate and the subsequent eruption of magma. This process is known as subduction, and it results in the formation of volcanic mountains and the release of volcanic gases.The presence of intermediate volcanic rocks suggests that this region experienced a subduction event involving the convergence of two tectonic plates. The magma that formed these rocks likely originated from the partial melting of the subducting plate, which was rich in silica and other minerals. As the magma rose to the surface, it cooled and solidified, forming the volcanic rocks we see today.Furthermore, the age of these volcanic rocks provides valuable information about the tectonic history of this region. The Pliocene epoch corresponds to a time when the tectonic plates in this area were actively converging. This convergence resulted in the formation of a volcanic arc, which extended along the western margin of the continent.In conclusion, the intermediate volcanic rocks we observe at this point location offer a glimpse into the dynamic geologic history of this region. They indicate a period of intense volcanic activity during the Pliocene epoch, likely associated with the subduction of tectonic plates and the formation of a volcanic arc. By studying these rocks and their context within the regional geology, we can gain valuable insights into the processes that have shaped our planet over millions of years.
```

#### France, Cassis area

![France by sea Screenshot](../static/images/blog/LAGDALimages/ScreenshotFranceSea.png)


```
Location: latitude = 43.202428, longitude = 5.498101

Geology Response: Good morning, students! Welcome to our geology field trip. Today, we find ourselves at a fascinating location with coordinates latitude = 43.202428 and longitude = 5.498101. As we stand here, we can observe an intriguing rock outcrop that provides us with valuable insights into the geologic history of this region.At this point location, the uppermost surface geology is composed of carbonate sedimentary rock and limestone of Early Cretaceous age. This layer was likely deposited in a continental shelf setting. This tells us that during the Early Cretaceous period, this area was covered by a shallow sea, where the accumulation of carbonate sediments and the growth of marine organisms led to the formation of limestone.Now, let's zoom out and explore the broader regional geology. The region surrounding our current location is part of the Provence-Alpes-Côte d'Azur region in southeastern France. This area is known for its complex geologic history, shaped by tectonic forces and the interplay of various sedimentary environments.During the Early Cretaceous period, the region was situated on the northern margin of the Tethys Ocean, a vast body of water that separated the supercontinents of Gondwana and Laurasia. As sea levels rose and fell, the area alternated between marine and terrestrial environments, resulting in the deposition of different sedimentary layers.Over time, tectonic forces caused the closure of the Tethys Ocean, leading to the collision of the African and Eurasian plates. This collision resulted in the formation of the Alps, a majestic mountain range that stretches across several European countries, including France. The intense pressure and folding associated with this collision caused the rocks in our current location to be uplifted and exposed.As we examine the limestone outcrop, we can see evidence of the tectonic forces that shaped this region. The rock layers may exhibit folding, faulting, or even metamorphism, indicating the immense pressures and temperatures they experienced during the mountain-building process.In addition to the tectonic forces, the region's geologic history has also been influenced by erosion and weathering. The action of wind, water, and ice has sculpted the landscape, exposing the underlying rock layers and creating the diverse topography we see today.In conclusion, the carbonate sedimentary rock and limestone we observe at this point location provide us with a glimpse into the Early Cretaceous period when this area was submerged beneath a shallow sea. Zooming out, we see that the regional geology has been shaped by tectonic forces, resulting in the formation of the Alps and the exposure of these rocks. Erosion and weathering have further contributed to the unique landscape of this region. I hope this overview of the geologic story around our current coordinates has piqued your interest and sparked your curiosity for further exploration. Let's continue our field trip and discover more fascinating geologic features!
```


--------------------------------


### Comparing geologic maps as models and large language models. Wrong and useful in different ways

#### Geologic maps as models

#### How map resolution ties to being wrong

#### How purpose of the geologic map ties to it being wrong

#### What type of geology is represented in a map?





#### Don't use Large language models as crystal balls

#### Changing large language models version of resolution

#### Large language models problems with point geology vs reginal geologic content

#### Changing large language models version of purpose

#### Common geographic pitfalls with large language models

## Most common types of errors experienced in France when combining geologic maps and large language models

- Spatial resolution (mostly a geologic map problem)

- Type/Purpose of the map (mostly a geologic map problem... somewhat solvable with LLMs and better programming?)

- What's important to talk about? (mostly a LLM problem)

- Speed (LLM problem... for now)

## Is there value?

### Accessibility?

### Education?

...Scams I see on Twitter

## Uncertainty on how much work to get something useful for non-niche-nerds

Not sure about how far down you have to go the tail of this type of problem to get something useful?

How to get users to think about their problems and the different types of uncertainty than they are used to?
